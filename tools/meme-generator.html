<!-- ツール共通テンプレート -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="まえゆきツールのミームジェネレーター - 自分だけのオリジナルミームを簡単に作成できる無料ツールです。テキストを追加して画像をシェアしましょう。">
  <title>ミームジェネレーター | まえゆきツール</title>

  <!-- リソースの先読み -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- 共通CSSとフォント -->
  <link rel="stylesheet" href="../css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&amp;display=swap" rel="stylesheet"></script>

  <!-- 個別ツールのスタイル -->
  <style>
    :root{--primary:#0066ff;--secondary:#ff3a3a;--accent:#ff9500;--dark-blue:#0d3283;--light-bg:#f8f9fa;--text-dark:#333;--text-mid:#555;--header-h:60px}*,::after,::before{box-sizing:border-box;margin:0;padding:0}body{font:16px/1.6 'Noto Sans JP',sans-serif;color:var(--text-dark);background:#fff;overflow-x:hidden;display:flex;flex-direction:column;min-height:100vh;-webkit-text-size-adjust:100%}img{max-width:100%;height:auto;vertical-align:middle;border:0}a{text-decoration:none;color:inherit}ul{list-style:none}main{flex:1 0 auto}.site-header{position:fixed;top:0;left:0;width:100%;z-index:1000;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.1);height:var(--header-h);display:flex;align-items:center}.header-container{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center;width:100%}.site-logo-text{font-weight:700;font-size:20px}.site-logo-text a{color:var(--dark-blue)}.hamburger-button{display:block;width:30px;height:30px;position:relative;z-index:1001;border:0;background:0;cursor:pointer}.hamburger-button span{display:block;position:absolute;width:100%;height:2px;background:var(--text-dark);left:0}.hamburger-button span:nth-child(1){top:8px}.hamburger-button span:nth-child(2){top:14px}.hamburger-button span:nth-child(3){bottom:8px}

     /* ミームジェネレータースタイル */
     .tool-section {
         padding: 80px 0 40px;
         margin-top: var(--header-h);
         background: #f9f3e9;
     }
     .tool-container {
         max-width: 840px;
         margin: 0 auto;
         padding: 0 20px;
     }
     .tool-title {
         font-size: 28px;
         text-align: center;
         margin-bottom: 1rem;
         color: var(--text-dark);
     }
     .tool-subtitle {
         font-size: 16px;
         color: var(--text-mid);
         text-align: center;
         margin-bottom: 8px;
     }
     .tool-label {
         font-size: 12px;
         display: table;
         margin: 0 auto;
         padding: 4px 10px;
         border-radius: 15px;
         background: var(--text-mid);
         color: #fff;
         letter-spacing: .05em;
     }

     /* ステップスタイル */
     .step-section {
         background: #fff;
         border-radius: 10px;
         padding: 25px;
         position: relative;
         margin-top: 30px;
         box-shadow: 0 4px 10px rgba(0,0,0,0.05);
     }
     .step-number {
         position: absolute;
         left: -10px;
         top: -10px;
         display: flex;
         align-items: center;
         justify-content: center;
         width: 30px;
         height: 30px;
         font-weight: 700;
         text-align: center;
         background: var(--primary);
         color: #fff;
         border-radius: 50%;
         font-size: 16px;
     }
     .step-title {
         font-size: 18px;
         margin-bottom: 10px;
         line-height: 1.3;
     }
     .step-description {
         font-size: 14px;
         color: var(--text-mid);
         margin-bottom: 15px;
     }

     /* ドロップエリア */
     .drop-area {
         border: 2px dashed #ccc;
         background: #f8f8f8;
         padding: 30px 20px;
         text-align: center;
         border-radius: 8px;
         margin-top: 15px;
         transition: all 0.3s;
     }
     .drop-area.dragover {
         border-color: var(--primary);
         background: rgba(0, 102, 255, 0.05);
     }
     .drop-area-icon {
         font-size: 32px;
         color: #ccc;
         margin-bottom: 10px;
     }
     .drop-area-text {
         margin-bottom: 5px;
         color: var(--text-mid);
     }
     .drop-area-or {
         font-size: 12px;
         color: var(--text-mid);
         margin-bottom: 10px;
     }
     .file-button {
         display: inline-block;
         padding: 10px 20px;
         background: var(--primary);
         color: #fff;
         border-radius: 8px;
         font-weight: 700;
         cursor: pointer;
         transition: all 0.3s;
     }
     .file-button:hover {
         background: #0055d4;
     }
     .file-input {
         display: none;
     }

     /* テンプレート選択エリア */
     .template-grid {
         display: flex;
         flex-wrap: wrap;
         gap: 10px;
         margin-top: 15px;
         justify-content: center;
     }
     .template-item {
         width: 100px;
         height: 100px;
         border-radius: 5px;
         object-fit: cover;
         border: 2px solid #eee;
         cursor: pointer;
         transition: all 0.2s;
     }
     .template-item:hover {
         border-color: var(--primary);
         transform: scale(1.05);
     }
     .template-item.active {
         border-color: var(--primary);
         box-shadow: 0 0 0 2px var(--primary);
     }

     /* ミームエディタ */
     .meme-editor {
         display: none;
         margin-top: 20px;
         position: relative;
     }
     .meme-canvas-container {
         position: relative;
         margin: 0 auto;
         max-width: 100%;
         overflow: hidden;
         background: #f0f0f0;
         border-radius: 8px;
     }
     #memeCanvas {
         display: block;
         max-width: 100%;
         margin: 0 auto;
         background: #fff;
     }

     /* テキスト設定パネル */
     .text-panel {
         margin-top: 20px;
         display: flex;
         flex-wrap: wrap;
         gap: 15px;
     }
     .text-input-group {
         flex: 1;
         min-width: 250px;
     }
     .text-input-label {
         display: block;
         margin-bottom: 5px;
         font-weight: 700;
     }
     .text-input {
         width: 100%;
         padding: 10px;
         border: 2px solid #ccc;
         border-radius: 5px;
         font-size: 16px;
     }
     .text-input:focus {
         border-color: var(--primary);
         outline: none;
     }

     /* テキスト設定オプション */
     .text-options {
         display: flex;
         flex-wrap: wrap;
         gap: 15px;
         margin-top: 15px;
         padding: 15px;
         background: #f5f5f5;
         border-radius: 8px;
     }
     .option-group {
         flex: 1;
         min-width: 120px;
     }
     .option-label {
         display: block;
         margin-bottom: 5px;
         font-size: 14px;
         font-weight: 700;
     }
     .option-select, .option-color {
         width: 100%;
         padding: 8px;
         border: 1px solid #ccc;
         border-radius: 4px;
     }
     .option-select:focus, .option-color:focus {
         border-color: var(--primary);
         outline: none;
     }

     /* ダウンロードボタン */
     .action-buttons {
         display: flex;
         justify-content: center;
         gap: 15px;
         margin-top: 20px;
     }
     .download-button, .share-button {
         padding: 12px 25px;
         font-weight: 700;
         font-size: 16px;
         border-radius: 8px;
         cursor: pointer;
         transition: all 0.3s;
         border: none;
         display: inline-flex;
         align-items: center;
         justify-content: center;
     }
     .download-button {
         background: var(--primary);
         color: #fff;
     }
     .download-button:hover {
         background: #0055d4;
     }
     .share-button {
         background: var(--text-dark);
         color: #fff;
     }
     .share-button:hover {
         background: #444;
     }
     .button-icon {
         margin-right: 8px;
     }

     /* テンプレートなし時のメッセージ */
     .no-template-message {
         text-align: center;
         padding: 30px;
         background: #f5f5f5;
         border-radius: 8px;
         margin-top: 20px;
     }

     /* 使い方ボックス */
     .usage-box {
         background: #fff;
         border-radius: 10px;
         padding: 25px;
         margin-top: 40px;
         box-shadow: 0 4px 10px rgba(0,0,0,0.05);
     }
     .usage-title {
         font-size: 18px;
         display: flex;
         align-items: center;
         margin-bottom: 15px;
         color: var(--text-dark);
     }
     .usage-title-icon {
         margin-right: 8px;
         color: var(--primary);
     }
     .usage-list {
         padding-left: 20px;
     }
     .usage-item {
         margin-bottom: 8px;
         position: relative;
         line-height: 1.5;
     }
     .usage-item::before {
         content: "•";
         position: absolute;
         left: -15px;
         color: var(--primary);
     }
     .usage-link {
         color: var(--primary);
     }
     .usage-link:hover {
         text-decoration: underline;
     }

     /* シェアダイアログ */
     .share-modal {
         display: none;
         position: fixed;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: rgba(0, 0, 0, 0.5);
         z-index: 1100;
         justify-content: center;
         align-items: center;
     }
     .share-dialog {
         background: #fff;
         border-radius: 10px;
         padding: 25px;
         max-width: 90%;
         width: 500px;
     }
     .share-dialog-title {
         font-size: 20px;
         margin-bottom: 15px;
         display: flex;
         justify-content: space-between;
         align-items: center;
     }
     .share-close {
         font-size: 24px;
         cursor: pointer;
         color: #666;
     }
     .share-close:hover {
         color: #000;
     }
     .share-preview {
         text-align: center;
         margin-bottom: 20px;
     }
     .share-preview img {
         max-width: 100%;
         max-height: 300px;
         margin: 0 auto;
         border-radius: 5px;
         box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
     }
     .share-options {
         display: flex;
         justify-content: center;
         gap: 15px;
     }
     .share-option {
         width: 50px;
         height: 50px;
         border-radius: 50%;
         display: flex;
         align-items: center;
         justify-content: center;
         color: #fff;
         cursor: pointer;
         transition: transform 0.2s;
     }
     .share-option:hover {
         transform: scale(1.1);
     }
     .share-twitter { background: #1DA1F2; }
     .share-facebook { background: #1877F2; }
     .share-line { background: #06C755; }
     .share-copy { background: #555; }

     /* シェアセクション */
     .share-section {
         margin: 40px 0;
         text-align: center;
     }
     .share-section-title {
         display: inline-block;
         position: relative;
         padding: 0 30px;
         margin-bottom: 15px;
         font-size: 16px;
         font-weight: 700;
     }
     .share-section-title:before, .share-section-title:after {
         content: "";
         position: absolute;
         top: 50%;
         width: 20px;
         height: 2px;
         background: var(--text-dark);
     }
     .share-section-title:before {
         left: 0;
         transform: rotate(50deg);
     }
     .share-section-title:after {
         right: 0;
         transform: rotate(-50deg);
     }
     .share-section-buttons {
         display: flex;
         justify-content: center;
         gap: 15px;
     }
     .share-section-button {
         display: flex;
         align-items: center;
         justify-content: center;
         width: 40px;
         height: 40px;
         border-radius: 50%;
         transition: transform 0.2s;
     }
     .share-section-button:hover {
         transform: scale(1.1);
     }

     /* 他のツールリンク */
     .other-tools {
         margin-top: 40px;
     }
     .other-tools-title {
         font-size: 18px;
         margin-bottom: 15px;
         text-align: center;
     }
     .tools-list {
         display: flex;
         flex-wrap: wrap;
         gap: 10px;
         justify-content: center;
     }
     .tool-link {
         display: inline-block;
         padding: 8px 16px;
         background: white;
         border-radius: 20px;
         border: 1px solid #e0e0e0;
         font-size: 14px;
         transition: all 0.2s;
     }
     .tool-link:hover {
         background: var(--primary);
         color: white;
         transform: translateY(-2px);
         border-color: var(--primary);
     }

     /* 読み込み中アニメーション */
     .loading {
         display: none;
         position: fixed;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: rgba(255, 255, 255, 0.8);
         z-index: 1100;
         justify-content: center;
         align-items: center;
     }
     .loading-spinner {
         width: 50px;
         height: 50px;
         border: 5px solid #f3f3f3;
         border-top: 5px solid var(--primary);
         border-radius: 50%;
         animation: spin 1s linear infinite;
     }
     @keyframes spin {
         0% { transform: rotate(0deg); }
         100% { transform: rotate(360deg); }
     }

     /* ドロップアニメーション */
     @keyframes drop-pulse {
         0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 102, 255, 0.4); }
         70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(0, 102, 255, 0); }
         100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 102, 255, 0); }
     }
     .drop-pulse {
         animation: drop-pulse 1.5s infinite;
     }

     /* レスポンシブ対応 */
     @media (max-width: 768px) {
         .tool-section {
             padding: 70px 0 30px;
         }
         .step-section {
             padding: 20px 15px;
         }
         .text-panel {
             flex-direction: column;
         }
         .text-options {
             flex-direction: column;
         }
         .meme-canvas-container {
             width: 100% !important;
             height: auto !important;
         }
     }
     @media (max-width: 480px) {
         .template-grid {
             justify-content: center;
         }
         .template-item {
             width: 80px;
             height: 80px;
         }
         .action-buttons {
             flex-direction: column;
         }
     }
  </style>

  <!-- JavaScriptの遅延ロード -->
  <script src="/js/script.js" defer></script>

  <link rel="icon" href="../assets/images/logo.webp" type="image/webp">
  <meta property="og:title" content="ミームジェネレーター | まえゆきツール">
  <meta property="og:description" content="まえゆきツールのミームジェネレーター - 自分だけのオリジナルミームを簡単に作成できる無料ツールです。テキストを追加して画像をシェアしましょう。">
  <meta property="og:image" content="/images/tool-ogp.webp">
  <meta property="og:type" content="website">
  <meta property="og:image" content="/images/ogp_image_tools.webp">
  <meta property="og:type" content="website">
  <!-- インクルード処理 -->

</head>
<body>
<!-- header -->  <!-- ヘッダー -->
  <header class="site-header">
    <div class="header-container">
        <div class="site-logo-text">
            <a href="../index.html">CLAN</a>
        </div>
        <nav class="global-nav pc-nav" aria-label="グローバルナビゲーション">
            <ul>
                <li><a href="../index.html">ホーム</a></li>
                <li><a href="../achievement/index.html">お客様の声</a></li>
                <li><a href="/blog/index.html">ブログ</a></li>
            <li><a href="../tools/index.html">まえゆきツール</a></li></ul>
        </nav>
        <div class="header-cta">
            <a href="https://utage-system.com/p/EcESO02xLLoK" class="btn-contact">
                無料相談
            </a>
        </div>
        <button class="hamburger-button sp-nav" aria-label="メニューを開く" type="button">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </div>
  </header>

  <!-- モバイルメニュー -->
  <div class="mobile-menu">
    <nav aria-label="モバイルメニュー">
        <ul>
            <li><a href="../index.html">ホーム</a></li>
            <li><a href="../achievement/index.html">お客様の声</a></li>
            <li><a href="/blog/index.html">ブログ</a></li>
        <li><a href="../tools/index.html">まえゆきツール</a></li></ul>
    </nav>
    <div class="mobile-cta">
        <a href="https://utage-system.com/p/EcESO02xLLoK" class="btn-contact">
            無料相談
        </a>
    </div>
  </div>


  <!-- メインコンテンツ -->
  <main class="site-main">
      <!-- ツールセクション -->
      <section class="tool-section">
         <div class="tool-container">
            <h1 class="tool-title">ミームジェネレーター</h1>
            <p class="tool-subtitle">画像にテキストを追加してミームを作ろう！</p>
            <span class="tool-label">JPEG/PNG対応</span>

            <!-- ステップ1: 画像選択 -->
            <div class="step-section">
               <span class="step-number">1</span>
               <h2 class="step-title">ミーム画像を選択</h2>
               <p class="step-description">テンプレートから選ぶか、自分の画像をアップロードしましょう</p>

               <div class="drop-area" id="dropArea">
                  <div class="drop-area-icon">
                     <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                     </svg>
                  </div>
                  <p class="drop-area-text">ここに画像ファイルをドラッグ＆ドロップ</p>
                  <p class="drop-area-or">もしくは</p>
                  <label class="file-button">
                     + 画像をアップロード
                     <input type="file" class="file-input" id="fileInput" accept="image/jpeg, image/png, image/gif">
                  </label>
               </div>

               <p style="text-align: center; margin-top: 20px; margin-bottom: 10px; font-weight: bold;">または人気のテンプレートから選ぶ</p>

               <div class="template-grid" id="templateGrid">
                  <!-- テンプレート画像は動的に追加されます -->
               </div>

            <!-- ステップ2: テキスト追加 -->
            <div class="step-section">
               <span class="step-number">2</span>
               <h2 class="step-title">テキストを追加</h2>
               <p class="step-description">ミームに上下のテキストを追加できます</p>

               <div id="memeEditor" class="meme-editor">
                  <div class="meme-canvas-container" id="canvasContainer">
                     <canvas id="memeCanvas"></canvas>
                  </div>

                  <div class="text-panel">
                     <div class="text-input-group">
                        <label class="text-input-label" for="topText">上のテキスト</label>
                        <input type="text" id="topText" class="text-input" placeholder="ここに上のテキストを入力">
                     </div>

                     <div class="text-input-group">
                        <label class="text-input-label" for="bottomText">下のテキスト</label>
                        <input type="text" id="bottomText" class="text-input" placeholder="ここに下のテキストを入力">
                     </div>

                  <div class="text-options">
                     <div class="option-group">
                        <label class="option-label" for="fontSize">フォントサイズ</label>
                        <select id="fontSize" class="option-select">
                           <option value="20">小さい</option>
                           <option value="30" selected="">普通</option>
                           <option value="40">大きい</option>
                           <option value="50">特大</option>
                        </select>
                     </div>

                     <div class="option-group">
                        <label class="option-label" for="fontFamily">フォント</label>
                        <select id="fontFamily" class="option-select">
                           <option value="Arial, sans-serif">Arial</option>
                           <option value="'Impact', sans-serif" selected="">Impact (ミーム定番)</option>
                           <option value="'Comic Sans MS', cursive">Comic Sans</option>
                           <option value="'Helvetica', sans-serif">Helvetica</option>
                           <option value="'Courier New', monospace">Courier</option>
                           <option value="'HGS創英角ｺﾞｼｯｸ UB', sans-serif">創英角ゴシック</option>
                        </select>
                     </div>

                     <div class="option-group">
                        <label class="option-label" for="textColor">テキスト色</label>
                        <input type="color" id="textColor" class="option-color" value="#ffffff">
                     </div>                     <div class="option-group">
                        <label class="option-label" for="strokeColor">枠線色</label>
                        <input type="color" id="strokeColor" class="option-color" value="#000000">
                     </div>
                  </div>
               </div>

               <div id="noTemplateMessage" class="no-template-message">
                  <p>画像を選択するとここにエディタが表示されます</p>
               </div>
            </div>

            <!-- ステップ3: ダウンロード/シェア -->
            <div class="step-section">
               <span class="step-number">3</span>
               <h2 class="step-title">完成したミームをダウンロード・シェア</h2>
               <p class="step-description">作成したミームを保存して皆とシェアしましょう</p>               <div class="action-buttons">
                  <button type="button" class="download-button" id="downloadBtn" disabled="">
                     <span class="button-icon">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                           <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                           <polyline points="7 10 12 15 17 10"></polyline>
                           <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                     </span>
                     ダウンロード
                  </button>

                  <button type="button" class="share-button" id="shareBtn" disabled="">
                     <span class="button-icon">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                           <circle cx="18" cy="5" r="3"></circle>
                           <circle cx="6" cy="12" r="3"></circle>
                           <circle cx="18" cy="19" r="3"></circle>
                           <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                           <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                        </svg>
                     </span>
                     SNSでシェア
                  </button>
               </div>
            </div>

            <!-- 使い方ボックス -->
            <div class="usage-box">
               <h3 class="usage-title">
                  <span class="usage-title-icon">
                     <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                     </svg>
                  </span>
                  ミームジェネレーターの使い方
               </h3>

               <ul class="usage-list">
                  <li class="usage-item">Web（ブラウザ）上ですぐに使えるミーム作成ツールです。</li>
                  <li class="usage-item">用意されたテンプレートから選ぶか、自分の画像をアップロードできます。</li>
                  <li class="usage-item">画像の上部と下部にテキストを追加できます。</li>
                  <li class="usage-item">フォントの種類、サイズ、色、枠線の色を変更できます。</li>
                  <li class="usage-item">完成したミームはダウンロードしたり、SNSでシェアしたりできます。</li>
                  <li class="usage-item">画像はパソコンやスマホのブラウザ上で処理されます。</li>
                  <li class="usage-item">サーバーなどに画像は送信されないため、画像を誰かに見られる心配はありません。</li>
                  <li class="usage-item">
                     <a href="../tools/image-resize/" class="usage-link">画像サイズ変更ツール</a>や
                     <a href="../tools/png-to-jpeg/" class="usage-link">PNG→JPEG変換ツール</a>もぜひご利用ください。
                  </li>
               </ul>            </div>

        <!-- 他のツールリンク -->        <div class="other-tools">
          <h2 class="other-tools-title">その他のまえゆきツール</h2>
          <div class="tools-list">
            <a href="calc.html" class="tool-link">世界の単位換算ツール</a>
            <a href="image-resize.html" class="tool-link">画像サイズ変更</a>
            <a href="png-jpeg-to-webp.html" class="tool-link">WebP変換ツール</a>
            <a href="png-to-jpeg.html" class="tool-link">PNG→JPEG変換</a>
            <a href="meme-generator.html" class="tool-link">ミームジェネレーター</a>
            <a href="letters-counter.html" class="tool-link">文字数カウント</a>
            <a href="color-palette.html" class="tool-link">カラーパレット</a>
            <a href="wareki-seireki.html" class="tool-link">年齢・和暦計算ツール</a>
          </div>
        </div>
      </div>
    </section>

    <!-- シェアモーダル -->
    <div class="share-modal" id="shareModal">
         <div class="share-dialog">
            <div class="share-dialog-title">
               <span>ミームをシェア</span>
               <span class="share-close" id="shareClose">×</span>
            </div>
            <div class="share-preview">
               <img id="sharePreviewImg" src="" alt="ミームのプレビュー" loading="lazy">
            </div>
            <div class="share-options">
               <a href="#" class="share-option share-twitter" id="shareTwitter">
                  <svg width="20" height="20" fill="#fff" viewBox="0 0 24 24"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg>
               </a>
               <a href="#" class="share-option share-facebook" id="shareFacebook">
                  <svg width="20" height="20" fill="#fff" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg>
               </a>
               <a href="#" class="share-option share-line" id="shareLine">
                  <svg width="20" height="20" fill="#fff" viewBox="0 0 24 24"><path d="M24 10.304c0-5.369-5.383-9.738-12-9.738-6.616 0-12 4.369-12 9.738 0 4.814 4.269 8.846 10.036 9.608.391.084.922.258 1.057.592.121.303.079.778.039 1.085l-.171 1.027c-.053.303-.242 1.186 1.039.647 1.281-.54 6.911-4.069 9.428-6.967 1.739-1.907 2.572-3.843 2.572-5.992zm-18.988-2.595c.129 0 .234.105.234.234v4.153c0 .129-.105.234-.234.234h-.662c-.129 0-.234-.105-.234-.234v-4.153c0-.129.105-.234.234-.234zm5.323 0c.129 0 .234.105.234.234v4.153c0 .129-.105.234-.234.234h-.661c-.129 0-.234-.105-.234-.234v-2.566l-1.838 2.481c-.051.067-.131.107-.215.107h-.033c-.084 0-.164-.04-.215-.107l-1.838-2.481v2.566c0 .129-.105.234-.234.234h-.662c-.129 0-.234-.105-.234-.234v-4.153c0-.129.105-.234.234-.234h.66c.085 0 .165.04.216.109l2.081 2.811 2.081-2.811c.051-.069.131-.109.216-.109zm5.323 0c.129 0 .234.105.234.234v4.153c0 .129-.105.234-.234.234h-.662c-.129 0-.234-.105-.234-.234v-4.153c0-.129.105-.234.234-.234zm2.662 0c.129 0 .234.105.234.234v4.153c0 .129-.105.234-.234.234h-.662c-.129 0-.234-.105-.234-.234v-4.153c0-.129.105-.234.234-.234z"></path></svg>
               </a>
               <div class="share-option share-copy" id="shareCopy">
                  <svg width="20" height="20" fill="#fff" viewBox="0 0 24 24"><path d="M20 2H10c-1.103 0-2 .897-2 2v4H4c-1.103 0-2 .897-2 2v10c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2v-4h4c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2zM4 20V10h10l.002 10H4zm16-6h-4v-4c0-1.103-.897-2-2-2h-4V4h10v10z"></path></svg>
               </div>
            </div>
         </div>
      </div>

      <!-- 読み込みインジケータ -->
      <div class="loading" id="loading">
         <div class="loading-spinner"></div>
      </div>

    <!-- SVGアイコン -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="icon-pdf" viewBox="0 0 24 24">
        <path d="M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5V11H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z"></path>
      </symbol>
    </svg>    <!-- 個別ツールのJavaScript -->
    <script>
      // ミームジェネレーター用のスクリプト - 完全版実装
      // 既に上部で実装済みのため、この部分は必要なし
    </script>  </main>
  
    <!-- 重大告知 -->
    <div class="important-notice">
        <h2>UTAGE構築代行丸投げちゃんとは？</h2>
        <a href="https://utage-system.com/p/EcESO02xLLoK" class="important-notice-button">詳細を見る</a>
    </div>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="cta-container">
            <h2 class="cta-title" data-aos="fade-up">IT導入補助金2025活用可能</h2>
            <h3 class="cta-subtitle" data-aos="fade-up" data-aos-delay="100">申請は完全丸投げOK！</h3>
            <p class="cta-text" data-aos="fade-up" data-aos-delay="200">
                UTAGEの導入で最大75万円の補助金が受けられます。<br>
                面倒な申請手続きはすべてお任せください。<br>
                あなたは事業成長に集中するだけでOKです。
            </p>
            <div class="cta-buttons" data-aos="fade-up" data-aos-delay="300">
                <a href="https://utage-marunage.com/it-hojo/" class="cta-btn">無料相談してみる</a>
            </div>
        </div>
    </section>

  <!-- フッター -->
  <footer class="site-footer">
    <div class="footer-container">
      <div class="footer-brand">
        <h2>CLAN</h2>
      </div>
      <div class="footer-links">        <ul>
          <li><a href="../achievement/index.html">お客様の声</a></li>
          <li><a href="/blog/index.html">ブログ</a></li>
          <li><a href="../tools/index.html">まえゆきツール</a></li>
          <li><a href="../owner.html">運営者情報</a></li>
          <li><a href="../terms.html">利用規約</a></li>
          <li><a href="../privacy.html">プライバシーポリシー</a></li>
          <li><a href="../tokutei.html">特定商取引法に基づく表記</a></li>
        </ul>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        // ハンバーガーメニューの制御
        const hamburgerButton = document.querySelector('.hamburger-button');
        const mobileMenu = document.querySelector('.mobile-menu');
        
        if (hamburgerButton && mobileMenu) {
            hamburgerButton.addEventListener('click', function() {
                mobileMenu.classList.toggle('active');
                hamburgerButton.classList.toggle('active');
            });
        }

        // すべてのAOS要素を確実に表示状態にする
        const allAosElements = document.querySelectorAll('[data-aos]');
        if (allAosElements.length > 0) {
            allAosElements.forEach(el => {
                el.classList.add('aos-animate');
                el.style.opacity = '1';
                el.style.transform = 'none';
                el.removeAttribute('data-aos');
            });
        }
        
        // AOS初期化 - アニメーションを完全に無効化
        if (typeof AOS !== 'undefined') {
            AOS.init({
                duration: 0,
                easing: 'linear',
                once: true,
                offset: 0,
                disable: true,
                startEvent: 'DOMContentLoaded',
                disableMutationObserver: true
            });
            
            setTimeout(function() {
                document.querySelectorAll('*[data-aos]').forEach(function(el) {
                    el.style.opacity = '1';
                    el.style.transform = 'none';
                });
            }, 100);
        }

        // スクロール検出のためのIntersection Observer
        const fadeElements = document.querySelectorAll('.fade-in');
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, { threshold: 0.1 });

        fadeElements.forEach(element => {
            observer.observe(element);
        });
    });
  </script>
  
  <!-- ミームジェネレーター用JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        // 要素の参照
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('fileInput');
        const templateGrid = document.getElementById('templateGrid');
        const memeEditor = document.getElementById('memeEditor');
        const memeCanvas = document.getElementById('memeCanvas');
        const ctx = memeCanvas.getContext('2d');
        const topTextInput = document.getElementById('topText');
        const bottomTextInput = document.getElementById('bottomText');
        const fontSizeSelect = document.getElementById('fontSize');
        const fontFamilySelect = document.getElementById('fontFamily');
        const textColorInput = document.getElementById('textColor');
        const strokeColorInput = document.getElementById('strokeColor');
        const downloadBtn = document.getElementById('downloadBtn');
        const shareBtn = document.getElementById('shareBtn');
        const shareModal = document.getElementById('shareModal');
        const shareClose = document.getElementById('shareClose');
        const noTemplateMessage = document.getElementById('noTemplateMessage');

        // 状態管理
        let currentImage = null;
        let fontSize = 30;
        let fontFamily = "'Impact', sans-serif";
        let textColor = '#ffffff';
        let strokeColor = '#000000';

        // テンプレート画像の定義（プレースホルダー画像を使用）
        const templates = [
            { id: 1, name: 'Drake', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZmY2YjZiIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyNCIgZmlsbD0iI2ZmZmZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkRyYWtlPC90ZXh0Pjwvc3ZnPg==' },
            { id: 2, name: '注目される彼氏', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjNGVjZGM0Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyMCIgZmlsbD0iI2ZmZmZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuazqOebruOBleOCjOOCi+W9vOawj+OAguOCreODo+ODg+ODiDwvdGV4dD48L3N2Zz4=' },
            { id: 3, name: '女性と猫', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjNDViN2QxIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyNCIgZmlsbD0iI2ZmZmZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuWlsOaAp+OBqOeMqjwvdGV4dD48L3N2Zz4=' },
            { id: 4, name: '2つのボタン', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjdiNzMxIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyNCIgZmlsbD0iI2ZmZmZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPjLjgaTjga7jg5zjgr/jg7M8L3RleHQ+PC9zdmc+' },
            { id: 5, name: '進化する脳', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjNWYyN2NkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyNCIgZmlsbD0iI2ZmZmZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPumAsuWMluOBmeOCi+iEsy8vdGV4dD48L3N2Zz4=' },
            { id: 6, name: '意見を変えて', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMDBkMmQzIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyMCIgZmlsbD0iI2ZmZmZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuaEj+imi+OCkuWkieOBiOOBpjwvdGV4dD48L3N2Zz4=' }
        ];

        // テンプレートの表示
        function displayTemplates() {
            templateGrid.innerHTML = '';
            templates.forEach(template => {
                const img = document.createElement('img');
                img.src = template.url;
                img.alt = template.name;
                img.title = template.name;
                img.className = 'template-item';
                img.addEventListener('click', () => loadTemplate(template.url));
                templateGrid.appendChild(img);
            });
        }

        // ファイルドロップの設定
        if (typeof setupFileDropAndSelection === 'function') {
            setupFileDropAndSelection(dropArea, fileInput, handleFiles);
        } else {
            // フォールバック処理
            dropArea.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', (e) => handleFiles(e.target.files));
            
            // ドラッグ&ドロップ
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            dropArea.addEventListener('drop', (e) => {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            });
        }

        // ファイル処理
        function handleFiles(files) {
            const file = files[0];
            if (!file || !file.type.match('image.*')) {
                if (typeof updateUI === 'function') {
                    updateUI('画像ファイルを選択してください', true);
                } else {
                    alert('画像ファイルを選択してください');
                }
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => loadImage(e.target.result);
            reader.readAsDataURL(file);
        }

        // テンプレート読み込み
        function loadTemplate(url) {
            // アクティブなテンプレートのスタイルを更新
            document.querySelectorAll('.template-item').forEach(item => {
                item.classList.remove('active');
                if (item.src === url) item.classList.add('active');
            });
            loadImage(url);
        }

        // 画像読み込み
        function loadImage(src) {
            const img = new Image();
            img.crossOrigin = 'anonymous';
            img.onload = function() {
                currentImage = img;
                
                // キャンバスサイズを画像に合わせる（最大幅600px）
                const maxWidth = 600;
                const ratio = img.width / img.height;
                
                if (img.width > maxWidth) {
                    memeCanvas.width = maxWidth;
                    memeCanvas.height = maxWidth / ratio;
                } else {
                    memeCanvas.width = img.width;
                    memeCanvas.height = img.height;
                }
                
                // エディタを表示
                memeEditor.style.display = 'block';
                noTemplateMessage.style.display = 'none';
                downloadBtn.disabled = false;
                shareBtn.disabled = false;
                
                // 初期描画
                drawMeme();
            };
            img.src = src;
        }

        // ミーム描画
        function drawMeme() {
            if (!currentImage) return;

            // キャンバスをクリア
            ctx.clearRect(0, 0, memeCanvas.width, memeCanvas.height);
            
            // 画像を描画
            ctx.drawImage(currentImage, 0, 0, memeCanvas.width, memeCanvas.height);
            
            // テキスト設定
            ctx.font = `bold ${fontSize}px ${fontFamily}`;
            ctx.fillStyle = textColor;
            ctx.strokeStyle = strokeColor;
            ctx.lineWidth = Math.max(1, fontSize / 15);
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            
            // 上部テキスト
            const topText = topTextInput.value.toUpperCase();
            if (topText) {
                const y = fontSize * 0.5;
                drawTextWithStroke(topText, memeCanvas.width / 2, y);
            }
            
            // 下部テキスト
            ctx.textBaseline = 'bottom';
            const bottomText = bottomTextInput.value.toUpperCase();
            if (bottomText) {
                const y = memeCanvas.height - fontSize * 0.5;
                drawTextWithStroke(bottomText, memeCanvas.width / 2, y);
            }
        }

        // ストローク付きテキスト描画
        function drawTextWithStroke(text, x, y) {
            // テキストを行に分割（長い場合）
            const maxWidth = memeCanvas.width * 0.9;
            const words = text.split(' ');
            let line = '';
            let lines = [];
            
            for (let n = 0; n < words.length; n++) {
                const testLine = line + words[n] + ' ';
                const metrics = ctx.measureText(testLine);
                const testWidth = metrics.width;
                
                if (testWidth > maxWidth && n > 0) {
                    lines.push(line);
                    line = words[n] + ' ';
                } else {
                    line = testLine;
                }
            }
            lines.push(line);
            
            // 各行を描画
            const lineHeight = fontSize * 1.2;
            lines.forEach((line, index) => {
                const lineY = y + (index * lineHeight);
                // ストローク（枠線）を描画
                ctx.strokeText(line.trim(), x, lineY);
                // テキストを描画
                ctx.fillText(line.trim(), x, lineY);
            });
        }

        // イベントリスナー設定
        topTextInput.addEventListener('input', drawMeme);
        bottomTextInput.addEventListener('input', drawMeme);
        
        fontSizeSelect.addEventListener('change', (e) => {
            fontSize = parseInt(e.target.value);
            drawMeme();
        });
        
        fontFamilySelect.addEventListener('change', (e) => {
            fontFamily = e.target.value;
            drawMeme();
        });
        
        textColorInput.addEventListener('input', (e) => {
            textColor = e.target.value;
            drawMeme();
        });
        
        strokeColorInput.addEventListener('input', (e) => {
            strokeColor = e.target.value;
            drawMeme();
        });

        // ダウンロード機能
        downloadBtn.addEventListener('click', () => {
            if (!currentImage) return;
            
            try {
                memeCanvas.toBlob((blob) => {
                    if (blob) {
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `meme_${Date.now()}.png`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                        
                        if (typeof updateUI === 'function') {
                            updateUI('ミーム画像をダウンロードしました！');
                        }
                    }
                }, 'image/png');
            } catch (error) {
                console.error('ダウンロードエラー:', error);
                if (typeof updateUI === 'function') {
                    updateUI('ダウンロードに失敗しました', true);
                } else {
                    alert('ダウンロードに失敗しました');
                }
            }
        });

        // シェア機能
        shareBtn.addEventListener('click', () => {
            if (!currentImage) return;
            
            try {
                memeCanvas.toBlob((blob) => {
                    if (blob) {
                        const url = URL.createObjectURL(blob);
                        const sharePreviewImg = document.getElementById('sharePreviewImg');
                        if (sharePreviewImg) {
                            sharePreviewImg.src = url;
                        }
                        shareModal.style.display = 'flex';
                    }
                }, 'image/png');
            } catch (error) {
                console.error('シェアエラー:', error);
                if (typeof updateUI === 'function') {
                    updateUI('シェア機能の準備に失敗しました', true);
                } else {
                    alert('シェア機能の準備に失敗しました');
                }
            }
        });

        // シェアモーダル閉じる
        if (shareClose) {
            shareClose.addEventListener('click', () => {
                shareModal.style.display = 'none';
            });
        }

        // モーダル外クリックで閉じる
        shareModal.addEventListener('click', (e) => {
            if (e.target === shareModal) {
                shareModal.style.display = 'none';
            }
        });

        // シェアボタンのイベント
        const shareTwitter = document.getElementById('shareTwitter');
        const shareFacebook = document.getElementById('shareFacebook');
        const shareLine = document.getElementById('shareLine');
        const shareCopy = document.getElementById('shareCopy');

        if (shareTwitter) {
            shareTwitter.addEventListener('click', (e) => {
                e.preventDefault();
                const text = encodeURIComponent('私が作成したミーム画像です！ #まえゆきツール');
                const url = encodeURIComponent(window.location.href);
                window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
            });
        }

        if (shareFacebook) {
            shareFacebook.addEventListener('click', (e) => {
                e.preventDefault();
                const url = encodeURIComponent(window.location.href);
                window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
            });
        }

        if (shareLine) {
            shareLine.addEventListener('click', (e) => {
                e.preventDefault();
                const text = encodeURIComponent('私が作成したミーム画像です！');
                const url = encodeURIComponent(window.location.href);
                window.open(`https://social-plugins.line.me/lineit/share?url=${url}&text=${text}`, '_blank');
            });
        }

        if (shareCopy) {
            shareCopy.addEventListener('click', () => {
                navigator.clipboard.writeText(window.location.href).then(() => {
                    if (typeof updateUI === 'function') {
                        updateUI('URLをコピーしました！');
                    } else {
                        alert('URLをコピーしました！');
                    }
                }).catch(() => {
                    if (typeof updateUI === 'function') {
                        updateUI('URLのコピーに失敗しました', true);
                    } else {
                        alert('URLのコピーに失敗しました');
                    }
                });
            });
        }

        // ドラッグ&ドロップの設定
        function setupDragAndDrop() {
            // ドロップエリアのクリックでファイル選択
            dropArea.addEventListener('click', () => fileInput.click());
            
            // ファイル選択の変更
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFiles(e.target.files);
                }
            });
            
            // ドラッグイベントの設定
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            // ドラッグハイライト
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, () => {
                    dropArea.classList.add('dragover');
                }, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, () => {
                    dropArea.classList.remove('dragover');
                }, false);
            });

            // ドロップ処理
            dropArea.addEventListener('drop', (e) => {
                const dt = e.dataTransfer;
                const files = dt.files;
                if (files.length > 0) {
                    showLoading();
                    handleFiles(files);
                }
            });
        }

        // イベントリスナー設定
        function setupEventListeners() {
            try {
                // テキスト入力
                topTextInput.addEventListener('input', drawMeme);
                bottomTextInput.addEventListener('input', drawMeme);
                
                // フォント設定
                fontSizeSelect.addEventListener('change', (e) => {
                    fontSize = parseInt(e.target.value);
                    drawMeme();
                });
                
                fontFamilySelect.addEventListener('change', (e) => {
                    fontFamily = e.target.value;
                    drawMeme();
                });
                
                // 色設定
                textColorInput.addEventListener('input', (e) => {
                    textColor = e.target.value;
                    drawMeme();
                });
                
                strokeColorInput.addEventListener('input', (e) => {
                    strokeColor = e.target.value;
                    drawMeme();
                });

                // ダウンロード機能
                downloadBtn.addEventListener('click', () => {
                    if (!currentImage) return;
                    
                    try {
                        // PNG形式でダウンロード
                        memeCanvas.toBlob((blob) => {
                            if (blob) {
                                const url = URL.createObjectURL(blob);
                                const a = document.createElement('a');
                                a.href = url;
                                a.download = `meme_${Date.now()}.png`;
                                document.body.appendChild(a);
                                a.click();
                                document.body.removeChild(a);
                                URL.revokeObjectURL(url);
                                showMessage('ミーム画像をダウンロードしました！');
                            } else {
                                showMessage('ダウンロードに失敗しました', true);
                            }
                        }, 'image/png', 1.0);
                    } catch (error) {
                        console.error('ダウンロードエラー:', error);
                        showMessage('ダウンロードに失敗しました', true);
                    }
                });

                // シェア機能
                shareBtn.addEventListener('click', () => {
                    if (!currentImage) return;
                    
                    try {
                        memeCanvas.toBlob((blob) => {
                            if (blob) {
                                const url = URL.createObjectURL(blob);
                                const sharePreviewImg = document.getElementById('sharePreviewImg');
                                if (sharePreviewImg) {
                                    sharePreviewImg.src = url;
                                }
                                shareModal.style.display = 'flex';
                            } else {
                                showMessage('シェア準備に失敗しました', true);
                            }
                        }, 'image/png', 1.0);
                    } catch (error) {
                        console.error('シェアエラー:', error);
                        showMessage('シェア機能の準備に失敗しました', true);
                    }
                });

                // シェアモーダル閉じる
                if (shareClose) {
                    shareClose.addEventListener('click', () => {
                        shareModal.style.display = 'none';
                    });
                }

                // モーダル外クリックで閉じる
                shareModal.addEventListener('click', (e) => {
                    if (e.target === shareModal) {
                        shareModal.style.display = 'none';
                    }
                });

                // SNSシェア機能の設定
                setupSocialShare();
                
            } catch (error) {
                console.error('イベントリスナー設定エラー:', error);
            }
        }

        // SNSシェア機能
        function setupSocialShare() {
            const shareTwitter = document.getElementById('shareTwitter');
            const shareFacebook = document.getElementById('shareFacebook');
            const shareLine = document.getElementById('shareLine');
            const shareCopy = document.getElementById('shareCopy');

            if (shareTwitter) {
                shareTwitter.addEventListener('click', (e) => {
                    e.preventDefault();
                    const text = encodeURIComponent('私が作成したミーム画像です！ #まえゆきツール #ミーム');
                    const url = encodeURIComponent(window.location.href);
                    window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
                });
            }

            if (shareFacebook) {
                shareFacebook.addEventListener('click', (e) => {
                    e.preventDefault();
                    const url = encodeURIComponent(window.location.href);
                    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
                });
            }

            if (shareLine) {
                shareLine.addEventListener('click', (e) => {
                    e.preventDefault();
                    const text = encodeURIComponent('私が作成したミーム画像です！');
                    const url = encodeURIComponent(window.location.href);
                    window.open(`https://social-plugins.line.me/lineit/share?url=${url}&text=${text}`, '_blank');
                });
            }

            if (shareCopy) {
                shareCopy.addEventListener('click', async () => {
                    try {
                        await navigator.clipboard.writeText(window.location.href);
                        showMessage('URLをコピーしました！');
                    } catch (error) {
                        console.error('クリップボードエラー:', error);
                        showMessage('URLのコピーに失敗しました', true);
                    }
                });
            }
        }

        // 初期化
        function init() {
            try {
                displayTemplates();
                setupDragAndDrop();
                setupEventListeners();
                
                console.log('ミームジェネレーターが正常に初期化されました');
                
            } catch (error) {
                console.error('初期化エラー:', error);
                showMessage('アプリケーションの初期化に失敗しました', true);
            }
        }

        // アプリケーション開始
        init();
    });
  </script>
  
  <script>
    if (!window.isScriptLoaded || !window.isScriptLoaded('/js/include.js')) {
        document.write('<script src="/js/include.js"><\/script>');
    } else {
        console.log('include.jsのロードをスキップしました');
    }
</script>

<!-- 統合システムスクリプト（優先読み込み） -->
<script src="../js/common-cache.js" onerror="console.warn('common-cache.js not found')"></script>
<script src="../js/common-lazy-loading.js" onerror="console.warn('common-lazy-loading.js not found')"></script>
<script src="../js/common-init.js" onerror="console.warn('common-init.js not found')"></script>

<!-- footer -->
</body>
</html>





